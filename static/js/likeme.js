const likeMe=(()=>{let e;return t=>e||(e=new LikeMeSingleton(t))})();class LikeMeSingleton{constructor({el:e,serverURL:t,color:r="#ff9797"}){Object.assign(this,{el:e,url:t,color:r}),this.init()}async init(){await this.renderUI(),this.attachEvents(),this.updateCount()}async renderUI(){try{const e=await fetch(this.url),t=await e.text(),r=document.querySelector(this.el);r&&(r.innerHTML=(new DOMParser).parseFromString(t,"text/html").body.innerHTML,r.querySelector(".likeCard")?.style.setProperty("background-color",this.color))}catch(e){console.error("Render UI error:",e)}}attachEvents(){document.querySelector(`${this.el} .likeCard`)?.addEventListener("click",(()=>this.handleLike()))}async updateCount(){try{const e=await fetch(`${this.url}/info`);if(e.ok){const t=(await e.json()).data?.count||0,r=document.querySelector(`${this.el} .likeCard-text`);r&&(r.textContent=`❤ ${t}`)}}catch(e){console.error("Update count error:",e)}}async handleLike(){try{const e=await fetch(`${this.url}/like`);if(e.ok){const{code:t,data:{count:r=0}={},msg:n}=await e.json(),o=document.querySelector(`${this.el} .likeCard-text`);o&&(o.textContent="200"===t?`❤ ${r}`:n)}}catch(e){console.error("Handle like error:",e)}}}